function Create-CredentialVariable
{
<#
  .SYNOPSIS 
    Loads cred*.xml files as variables into the powershell instance
  .EXAMPLE
    Create-CredentialVariable ..\
#>
  [CmdletBinding()]
  param ( 
    [Parameter(Mandatory=$true,
      HelpMessage='Path to the credential files cred*.xml',
      ValueFromPipelineByPropertyName=$true,
      ValueFromPipeline=$true)]
      [Alias('FilePath')]
      [string[]]$Path
  ) 

  $credlist = Get-ChildItem $path cred*.xml -Name
    #only continue if there are cred files found.
    if ($credlist) 
    {
        foreach ( $credfile in $credlist ) {
            $credvar = ($credfile.substring(0,($credfile.indexof("."))))
            New-Variable -Name $credvar -Scope Global -Value (Import-PSCredential $path\$credfile) -force
        } #end foreach
        #remove variables no longer required
        Remove-Variable credlist
        Remove-Variable credfile
        Remove-Variable credvar
        #Display the credential variables that have been created.
        #Get-ChildItem variable:cred* | Select Name
    } else {
      Write-Output "No credential files found."
    } 

} 
